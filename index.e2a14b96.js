const e=new class{constructor(e){this.score=0,this.status="idle",e?this.field=e:this.field=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}moveLeft(){let e=[];for(let t of this.field)e.push(this._slideAndMergeRow(t));let t=!1;for(let l=0;l<4;l++){for(let i=0;i<4;i++)if(e[l][i]!==this.field[l][i]){t=!0;break}if(t)break}if(t){this.field=e;let t=[];for(let e=0;e<4;e++)for(let l=0;l<4;l++)0===this.field[e][l]&&t.push([e,l]);if(t.length>0){let[e,l]=t[Math.floor(Math.random()*t.length)];this.field[e][l]=.9>Math.random()?2:4}}}moveRight(){let e=[];for(let t of this.field){let l=[...t].reverse(),i=this._slideAndMergeRow(l);e.push(i.reverse())}let t=!1;for(let l=0;l<4;l++){for(let i=0;i<4;i++)if(e[l][i]!==this.field[l][i]){t=!0;break}if(t)break}if(t){this.field=e;let t=[];for(let e=0;e<4;e++)for(let l=0;l<4;l++)0===this.field[e][l]&&t.push([e,l]);if(t.length>0){let[e,l]=t[Math.floor(Math.random()*t.length)];this.field[e][l]=.9>Math.random()?2:4}}}moveUp(){let e=Array.from({length:4},()=>[,,,,].fill(0));for(let t=0;t<4;t++){let l=[this.field[0][t],this.field[1][t],this.field[2][t],this.field[3][t]],i=this._slideAndMergeRow(l);for(let l=0;l<4;l++)e[l][t]=i[l]}let t=!1;for(let l=0;l<4;l++){for(let i=0;i<4;i++)if(e[l][i]!==this.field[l][i]){t=!0;break}if(t)break}if(t){this.field=e;let t=[];for(let e=0;e<4;e++)for(let l=0;l<4;l++)0===this.field[e][l]&&t.push([e,l]);if(t.length>0){let[e,l]=t[Math.floor(Math.random()*t.length)];this.field[e][l]=.9>Math.random()?2:4}}}moveDown(){let e=Array.from({length:4},()=>[,,,,].fill(0));for(let t=0;t<4;t++){let l=[this.field[0][t],this.field[1][t],this.field[2][t],this.field[3][t]].reverse(),i=this._slideAndMergeRow(l).reverse();for(let l=0;l<4;l++)e[l][t]=i[l]}let t=!1;for(let l=0;l<4;l++){for(let i=0;i<4;i++)if(e[l][i]!==this.field[l][i]){t=!0;break}if(t)break}if(t){this.field=e;let t=[];for(let e=0;e<4;e++)for(let l=0;l<4;l++)0===this.field[e][l]&&t.push([e,l]);if(t.length>0){let[e,l]=t[Math.floor(Math.random()*t.length)];this.field[e][l]=.9>Math.random()?2:4}}}getScore(){return this.score}getState(){return this.field}getStatus(){if("idle"===this.status)return"idle";for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(2048===this.field[e][t])return"win";for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(0===this.field[e][t])return"playing";for(let e=0;e<4;e++)for(let t=0;t<3;t++)if(this.field[e][t]===this.field[e][t+1]||this.field[t][e]===this.field[t+1][e])return"playing";return"lose"}start(){this.score=0,this.status="playing",this.field=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(let e=0;e<2;e++){let e=[];for(let t=0;t<4;t++)for(let l=0;l<4;l++)0===this.field[t][l]&&e.push([t,l]);let[t,l]=e[Math.floor(Math.random()*e.length)];this.field[t][l]=.9>Math.random()?2:4}}restart(){this.field=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}_slideAndMergeRow(e){let t=e.filter(e=>0!==e),l=[];for(let e=0;e<t.length;e++)t[e]===t[e+1]?(l.push(2*t[e]),this.score+=2*t[e],e++):l.push(t[e]);for(;l.length<4;)l.push(0);return l}},t=document.querySelectorAll(".field-cell"),l=document.querySelector(".game-score"),i=document.querySelector(".button.start"),s=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),o=document.querySelector(".message-start");function f(){let i=e.getState();t.forEach((e,t)=>{let l=i[Math.floor(t/4)][t%4];e.textContent=0===l?"":l,e.className="field-cell",l&&e.classList.add(`field-cell--${l}`)}),l.textContent=e.getScore(),s.classList.toggle("hidden","win"!==e.getStatus()),r.classList.toggle("hidden","lose"!==e.getStatus()),o.classList.toggle("hidden","idle"!==e.getStatus())}document.addEventListener("keydown",t=>{if("playing"===e.getStatus()){switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}f()}}),i.addEventListener("click",()=>{"idle"===e.getStatus()?(e.start(),i.textContent="Restart",i.classList.remove("start"),i.classList.add("restart")):(e.restart(),i.textContent="Start",i.classList.remove("restart"),i.classList.add("start")),f()}),f();
//# sourceMappingURL=index.e2a14b96.js.map
